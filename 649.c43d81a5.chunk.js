"use strict";(self.webpackChunk_app_client=self.webpackChunk_app_client||[]).push([[649],{649:function(e,t,n){n.r(t),n.d(t,{default:function(){return g}});var r=n(294),c=n(977),o=n(12),s=n(433),u=n(581),a=n(477),l={position:new a.Vector3(0,5,10)};function i(e){let{children:t}=e;return r.createElement(r.Fragment,null,r.createElement(s.c,{makeDefault:!0,position:l.position},r.createElement("group",{"position-z":-1*l.position.z},t)),r.createElement(u.z,{makeDefault:!0}))}var m=n(320),f=n(896),p=n(946);function d(e,t,n){const c=r.useRef(t);r.useMemo((()=>{c.current=t}),[t]);const o=r.useRef(n);r.useMemo((()=>{o.current=n}),[n]),r.useEffect((()=>(window.addEventListener(e,c.current,o.current),()=>{window.removeEventListener(e,c.current,o.current)})),[e])}a.Mesh.prototype.raycast=m.uL;let E=new a.Box3;function y(e){let{speed:t=.05}=e;const n=r.useRef(new a.Vector3),c=function(e){const t=r.useRef([]);return d("keydown",(n=>{const r=t.current,c=n.key.toLowerCase();e.includes(c)&&!r.includes(c)&&r.push(c)})),d("keyup",(e=>{const n=t.current,r=e.key.toLowerCase(),c=n.indexOf(r);-1!==c&&n.splice(c,1)})),t.current}(["w","s","a","d"," "]),o=r.useRef(),s=r.useRef();return r.useEffect((()=>{const e=o.current,t=s.current;e.geometry.boundsTree=new f.r(e.geometry),t.geometry.boundsTree=new f.r(t.geometry)}),[]),(0,p.x)((e=>{let{raycaster:r}=e;r.firstHitOnly=!0;const u=o.current,a=s.current,l=n.current;!function(e,t){t.set(0,0,0),e.forEach((e=>{"w"===e&&(t.z=-1),"s"===e&&(t.z=1),"a"===e&&(t.x=-1),"d"===e&&(t.x=1)}))}(c,l),u.position.add(l.multiplyScalar(t)),a.geometry.boundsTree.shapecast({intersectsBounds:e=>(E=E.makeEmpty(),e.intersectsBox(E)),intersectsTriangle(){}})})),r.createElement("group",null,r.createElement("mesh",{ref:o,position:[0,.5,0],userData:{name:"player"}},r.createElement("boxBufferGeometry",null),r.createElement("meshBasicMaterial",{color:"crimson"})),r.createElement("mesh",{ref:s,userData:{name:"floor"},rotation:[a.MathUtils.degToRad(-90),0,0]},r.createElement("planeBufferGeometry",{args:[3,3]}),r.createElement("meshBasicMaterial",{color:"grey",side:a.DoubleSide})))}function w(){return r.createElement(c.Xz,{flat:!0,linear:!0,dpr:1},r.createElement(r.Suspense,{fallback:r.createElement(o.x,null,"Loading...")},r.createElement(i,null),r.createElement(y,null)))}function g(){return r.createElement(r.Fragment,null,r.createElement(w,null))}new a.Vector3(0,-1,0)}}]);
//# sourceMappingURL=649.c43d81a5.chunk.js.map